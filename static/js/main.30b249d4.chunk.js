(this.webpackJsonpfiregram=this.webpackJsonpfiregram||[]).push([[0],{16:function(e,t,r){e.exports=r(26)},21:function(e,t,r){},26:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),l=r(15),c=r.n(l),u=(r(21),r(5)),o={loggedIn:!1},i=function(e,t){switch(t.type){case"sign_in":return{loggedIn:!0,displayName:t.payload.displayName,email:t.payload.email,id:t.payload.id};case"sign_out":return{loggedIn:!1};default:return e}},s=n.a.createContext(),p=function(e){var t=Object(a.useReducer)(i,o),r=Object(u.a)(t,2),l=r[0],c=r[1];return n.a.createElement(s.Provider,{value:{user:l,userDispatch:c}},e.children)},d=r(9),f=r.n(d),m=r(12),g={apiKey:"AIzaSyDs77phTnoaiUAZZd8ak_Gvv5ozeBtZ4XM",authDomain:"firegram-70a8a.firebaseapp.com",projectId:"firegram-70a8a",storageBucket:"firegram-70a8a.appspot.com",messagingSenderId:"984077982923",appId:"1:984077982923:web:eff5bef8df8968bf538f4e"},b=r(11);r(27),r(28),r(24);b.a.initializeApp(g);var y=b.a.storage(),E=b.a.firestore(),v=b.a.firestore.FieldValue.serverTimestamp,j=(b.a.firestore.FieldValue.delete,b.a.auth()),h=new b.a.auth.GoogleAuthProvider,O=function(){var e=Object(m.a)(f.a.mark((function e(t,r,a){var n,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.ref(a),l=E.collection(t).doc(r),e.next=4,n.delete();case 4:return e.next=6,l.delete();case 6:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();var N=function(){var e=Object(a.useContext)(s),t=e.user,r=e.userDispatch;return[t,function(){j.signInWithPopup(h).then((function(e){r({type:"sign_in",payload:{displayName:e.user.displayName,email:e.user.email,id:e.user.uid}})})).catch((function(e){return console.log(e)}))},function(){j.signOut().then((function(e){r({type:"sign_out"})})).catch((function(e){console.log(e)}))}]},w=function(){var e=N(),t=Object(u.a)(e,3),r=t[0],a=t[1],l=t[2];return n.a.createElement("div",{className:"title"},n.a.createElement("h1",null,"FireGram"),!r.loggedIn&&n.a.createElement("button",{onClick:a},"Sign In"),r.loggedIn&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Hello, ",r.displayName),n.a.createElement("button",{onClick:l},"Sign Out"),n.a.createElement("h2",null,"Your Pictures"),n.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit.")))},I=r(10),_=function(e){var t=Object(a.useState)([]),r=Object(u.a)(t,2),n=r[0],l=r[1],c=Object(a.useState)(e),o=Object(u.a)(c,2),i=o[0],s=o[1];return Object(a.useEffect)((function(){var e=E.collection(i).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(I.a)(Object(I.a)({},e.data()),{},{id:e.id}))})),l(t)}));return function(){return e}}),[i]),{docs:n,setCollection:s}},k=function(e){var t=e.url,r=e.deleteImage,l=Object(a.useState)(!1),c=Object(u.a)(l,2),o=c[0],i=c[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"img-container"},n.a.createElement("img",{src:t,alt:"uploaded image",onMouseOver:function(){return i(!0)},onMouseOut:function(){return i(!1)}})),o&&n.a.createElement("button",{className:"delete-btn",onClick:r},"X"))},S=function(){var e=N(),t=Object(u.a)(e,1)[0],r=_(t.id).docs;return n.a.createElement("div",{className:"img-grid"},r&&r.map((function(e){return n.a.createElement("div",{className:"img-wrap",key:e.id},n.a.createElement(k,{url:e.url,deleteImage:function(){return O(t.id,e.id,e.fileName)},key:e.id}))})))},x={progress:0,error:"",fileUrl:""},C=function(e,t){switch(t.type){case"update_progress":return Object(I.a)(Object(I.a)({},e),{},{error:null,progress:t.payload});case"error":return{error:t.payload};case"set_url":return Object(I.a)(Object(I.a)({},e),{},{error:null,fileUrl:t.payload})}},F=function(e,t){var r=Object(a.useReducer)(C,x),n=Object(u.a)(r,2),l=n[0],c=n[1],o=Object(a.useState)(t),i=Object(u.a)(o,2),s=i[0];i[1];return Object(a.useEffect)((function(){var t=function(e){var t=(e=e.split(/(?=.png|.jpg|.jpeg)/)).pop();return e.push(Date.now(),t),e.join().replace(",","")}(e.name),r=E.collection(s),a=y.ref(t);a.put(e).on("state_changed",(function(e){c({type:"update_progress",payload:e.bytesTransferred/e.totalBytes*100})}),(function(e){c({type:"error",payload:e})}),Object(m.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getDownloadURL();case 2:n=e.sent,r.add({fileName:t,url:n,createdAt:v()}),c({type:"set_url",payload:n});case 5:case"end":return e.stop()}}),e)}))))}),[e,s]),l},A=function(e){var t=e.file,r=e.resetFile,l=Object(a.useContext)(s),c=l.user,u=(l.userDispatch,F(t,c.id)),o=u.progress,i=(u.error,u.fileUrl);return Object(a.useEffect)((function(){i&&r()}),[i,r]),console.log(o),n.a.createElement("div",{className:"progress-bar"},n.a.createElement("progress",{value:o,max:100,style:{width:"100%"}}))},D={file:null,error:null},P=function(e,t){switch(t.type){case"set_file":return{file:t.payload,error:null};case"error":return{file:null,error:t.payload};case"reset":return{file:null,error:null};default:return e}},G=function(){var e=Object(a.useReducer)(P,D),t=Object(u.a)(e,2),r=t[0],l=t[1],c=["image/png","image/jpeg"];return n.a.createElement("form",null,n.a.createElement("label",null,n.a.createElement("input",{type:"file",onChange:function(e){var t=e.target.files[0];t&&c.includes(t.type)?l({type:"set_file",payload:t}):l({type:"error",payload:"Error: Selected file is not of type PNG or JPG/JPEG"})}}),n.a.createElement("span",null,"+")),n.a.createElement("div",{className:"output"},r.error&&n.a.createElement("h1",null,r.error),r.file&&n.a.createElement("h1",null,r.file.name),r.file&&n.a.createElement(A,{file:r.file,resetFile:function(){return l({type:"reset"})}})))};var B=function(){var e=N(),t=Object(u.a)(e,3),r=t[0];return t[1],t[2],n.a.createElement("div",{className:"App"},n.a.createElement(w,null),r.loggedIn&&n.a.createElement(n.a.Fragment,null,n.a.createElement(G,null),n.a.createElement(S,null)))};c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(p,null,n.a.createElement(B,null))),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.30b249d4.chunk.js.map