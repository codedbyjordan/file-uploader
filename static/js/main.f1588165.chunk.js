(this.webpackJsonpfiregram=this.webpackJsonpfiregram||[]).push([[0],{16:function(e,t,a){e.exports=a(26)},21:function(e,t,a){},26:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),l=a(15),c=a.n(l),o=(a(21),a(5)),u=a(9),i=a.n(u),s=a(12),p={apiKey:"AIzaSyDs77phTnoaiUAZZd8ak_Gvv5ozeBtZ4XM",authDomain:"firegram-70a8a.firebaseapp.com",projectId:"firegram-70a8a",storageBucket:"firegram-70a8a.appspot.com",messagingSenderId:"984077982923",appId:"1:984077982923:web:eff5bef8df8968bf538f4e"},d=a(11);a(27),a(28),a(24);d.a.initializeApp(p);var f=d.a.storage(),m=d.a.firestore(),g=d.a.firestore.FieldValue.serverTimestamp,y=(d.a.firestore.FieldValue.delete,d.a.auth()),b=new d.a.auth.GoogleAuthProvider,E=function(){var e=Object(s.a)(i.a.mark((function e(t,a,r){var n,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.ref(r),l=m.collection(t).doc(a),e.next=4,n.delete();case 4:return e.next=6,l.delete();case 6:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}();var v={},h=function(e,t){switch(t.type){case"sign_in":return{loggedIn:!0,displayName:t.payload.displayName,email:t.payload.email,id:t.payload.id};case"sign_out":return{loggedIn:!1};default:return e}},j=n.a.createContext(),O=function(e){var t=Object(r.useReducer)(h,v),a=Object(o.a)(t,2),l=a[0],c=a[1];return Object(r.useEffect)((function(){y.onAuthStateChanged((function(e){e&&c({type:"sign_in",payload:{displayName:e.displayName,email:e.email,id:e.uid}})}))}),[y.onAuthStateChanged]),console.log(l),n.a.createElement(j.Provider,{value:{user:l,userDispatch:c}},e.children)},N=function(){var e=Object(r.useContext)(j),t=e.user,a=e.userDispatch;return[t,function(){y.signInWithPopup(b).then((function(e){a({type:"sign_in",payload:{displayName:e.user.displayName,email:e.user.email,id:e.user.uid}})})).catch((function(e){return console.log(e)}))},function(){y.signOut().then((function(e){a({type:"sign_out"})})).catch((function(e){console.log(e)}))}]},w=function(){var e=N(),t=Object(o.a)(e,3),a=t[0],r=t[1],l=t[2];return n.a.createElement("div",{className:"title"},n.a.createElement("h1",null,"Jordan's Image Uploader"),!a.loggedIn&&n.a.createElement("button",{onClick:r},"Sign In"),a.loggedIn&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Hello, ",a.displayName),n.a.createElement("button",{onClick:l},"Sign Out"),n.a.createElement("h2",null,"Your Pictures"),n.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit.")))},I=a(10),S=function(e){var t=Object(r.useState)([]),a=Object(o.a)(t,2),n=a[0],l=a[1],c=Object(r.useState)(e),u=Object(o.a)(c,2),i=u[0],s=u[1];return Object(r.useEffect)((function(){var e=m.collection(i).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(I.a)(Object(I.a)({},e.data()),{},{id:e.id}))})),l(t)}));return function(){return e}}),[i]),{docs:n,setCollection:s}},_=function(e){var t=e.url,a=e.deleteImage,l=Object(r.useState)(!1),c=Object(o.a)(l,2),u=c[0],i=c[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"img-container"},n.a.createElement("img",{src:t,alt:"uploaded image",onMouseOver:function(){return i(!0)},onMouseOut:function(){return i(!1)}})),u&&n.a.createElement("button",{className:"delete-btn",onClick:a},"X"))},k=function(){var e=N(),t=Object(o.a)(e,1)[0],a=S(t.id).docs;return n.a.createElement("div",{className:"img-grid"},a&&a.map((function(e){return n.a.createElement("div",{className:"img-wrap",key:e.id},n.a.createElement(_,{url:e.url,deleteImage:function(){return E(t.id,e.id,e.fileName)},key:e.id}))})))},x={progress:0,error:"",fileUrl:""},C=function(e,t){switch(t.type){case"update_progress":return Object(I.a)(Object(I.a)({},e),{},{error:null,progress:t.payload});case"error":return{error:t.payload};case"set_url":return Object(I.a)(Object(I.a)({},e),{},{error:null,fileUrl:t.payload})}},A=function(e,t){var a=Object(r.useReducer)(C,x),n=Object(o.a)(a,2),l=n[0],c=n[1],u=Object(r.useState)(t),p=Object(o.a)(u,2),d=p[0];p[1];return Object(r.useEffect)((function(){var t=function(e){var t=(e=e.split(/(?=.png|.jpg|.jpeg)/)).pop();return e.push(Date.now(),t),e.join().replace(",","")}(e.name),a=m.collection(d),r=f.ref(t);r.put(e).on("state_changed",(function(e){c({type:"update_progress",payload:e.bytesTransferred/e.totalBytes*100})}),(function(e){c({type:"error",payload:e})}),Object(s.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDownloadURL();case 2:n=e.sent,a.add({fileName:t,url:n,createdAt:g()}),c({type:"set_url",payload:n});case 5:case"end":return e.stop()}}),e)}))))}),[e,d]),l},D=function(e){var t=e.file,a=e.resetFile,l=Object(r.useContext)(j),c=l.user,o=(l.userDispatch,A(t,c.id)),u=o.progress,i=(o.error,o.fileUrl);return Object(r.useEffect)((function(){i&&a()}),[i,a]),console.log(u),n.a.createElement("div",{className:"progress-bar"},n.a.createElement("progress",{value:u,max:100,style:{width:"100%"}}))},F={file:null,error:null},P=function(e,t){switch(t.type){case"set_file":return{file:t.payload,error:null};case"error":return{file:null,error:t.payload};case"reset":return{file:null,error:null};default:return e}},U=function(){var e=Object(r.useReducer)(P,F),t=Object(o.a)(e,2),a=t[0],l=t[1],c=["image/png","image/jpeg"];return n.a.createElement("form",null,n.a.createElement("label",null,n.a.createElement("input",{type:"file",onChange:function(e){var t=e.target.files[0];t&&c.includes(t.type)?l({type:"set_file",payload:t}):l({type:"error",payload:"Error: Selected file is not of type PNG or JPG/JPEG"})}}),n.a.createElement("span",null,"+")),n.a.createElement("div",{className:"output"},a.error&&n.a.createElement("h1",null,a.error),a.file&&n.a.createElement("h1",null,a.file.name),a.file&&n.a.createElement(D,{file:a.file,resetFile:function(){return l({type:"reset"})}})))};var B=function(){var e=N(),t=Object(o.a)(e,3),a=t[0];return t[1],t[2],n.a.createElement("div",{className:"App"},n.a.createElement(w,null),a.loggedIn&&n.a.createElement(n.a.Fragment,null,n.a.createElement(U,null),n.a.createElement(k,null)))};c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(O,null,n.a.createElement(B,null))),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.f1588165.chunk.js.map