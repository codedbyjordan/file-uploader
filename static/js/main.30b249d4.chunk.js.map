{"version":3,"sources":["contexts/User.js","firebase/config.js","firebase/firebaseFunctions.js","hooks/useUser.js","components/Title.jsx","hooks/useFirestore.js","components/Image.jsx","components/ImageGrid.jsx","hooks/useStorage.js","components/ProgressBar.jsx","components/UploadForm.jsx","App.js","index.js"],"names":["initialUserState","loggedIn","userReducer","state","action","type","displayName","payload","email","id","UserContext","React","createContext","UserProvider","props","useReducer","user","userDispatch","Provider","value","children","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebase","initializeApp","projectStorage","storage","projectFirestore","firestore","createTimestamp","FieldValue","serverTimestamp","firebaseAuth","delete","auth","googleAuthProvider","GoogleAuthProvider","deleteFile","collection","fileName","a","storageRef","ref","dbRef","doc","useUser","useContext","signInWithPopup","then","result","uid","catch","err","console","log","signOut","data","Title","signIn","className","onClick","useFirestore","collectionName","useState","docs","setDocs","setCollection","useEffect","unsubFromCollection","orderBy","onSnapshot","snapshot","documents","forEach","document","push","Image","url","deleteImage","deleteIsShown","setDeleteIsShown","src","alt","onMouseOver","onMouseOut","ImageGrid","map","key","initialState","progress","error","fileUrl","storageReducer","useStorage","file","storageDispatch","str","extension","split","pop","Date","now","join","replace","fileNameWithId","name","collectionRef","put","on","bytesTransferred","totalBytes","getDownloadURL","add","createdAt","ProgressBar","resetFile","max","style","width","fileReducer","UploadForm","fileDispatch","allowedFileTypes","onChange","e","selectedFile","target","files","includes","App","ReactDOM","render","StrictMode","User","getElementById"],"mappings":"yNAEMA,EAAmB,CACvBC,UAAU,GAGNC,EAAc,SAACC,EAAOC,GAC1B,OAAOA,EAAOC,MACZ,IAAK,UACH,MAAO,CACLJ,UAAU,EACVK,YAAaF,EAAOG,QAAQD,YAC5BE,MAAOJ,EAAOG,QAAQC,MACtBC,GAAIL,EAAOG,QAAQE,IAEvB,IAAK,WACH,MAAO,CACLR,UAAU,GAEd,QACE,OAAOE,IAIPO,EAAcC,IAAMC,gBAaXC,EAXM,SAACC,GAEpB,MAA6BC,qBAAWb,EAAaF,GAArD,mBAAOgB,EAAP,KAAaC,EAAb,KAEA,OACE,kBAACP,EAAYQ,SAAb,CAAsBC,MAAO,CAACH,OAAMC,iBACjCH,EAAMM,W,wBCvBEC,EATQ,CACrBC,OAAQ,0CACRC,WAAY,iCACZC,UAAW,iBACXC,cAAe,6BACfC,kBAAmB,eACnBC,MAAO,6C,0BCETC,IAASC,cAAcR,GAEvB,IAAMS,EAAiBF,IAASG,UAC1BC,EAAmBJ,IAASK,YAC5BC,EAAkBN,IAASK,UAAUE,WAAWC,gBAIhDC,GAHcT,IAASK,UAAUE,WAAWG,OAG7BV,IAASW,QACxBC,EAAqB,IAAIZ,IAASW,KAAKE,mBAEvCC,EAAU,uCAAG,WAAMC,EAAYlC,EAAImC,GAAtB,iBAAAC,EAAA,6DACXC,EAAahB,EAAeiB,IAAIH,GAClCI,EAAQhB,EAAiBW,WAAWA,GAAYM,IAAIxC,GAFvC,SAGXqC,EAAWR,SAHA,uBAIXU,EAAMV,SAJK,2CAAH,0DCfhB,IA6BeY,EA7BC,WAEd,MAA+BC,qBAAWzC,GAAlCM,EAAR,EAAQA,KAAMC,EAAd,EAAcA,aAuBd,MAAO,CAACD,EArBO,WACbqB,EAAae,gBAAgBZ,GAAoBa,MAAK,SAACC,GACrDrC,EAAa,CACXZ,KAAM,UACNE,QAAS,CACPD,YAAagD,EAAOtC,KAAKV,YACzBE,MAAO8C,EAAOtC,KAAKR,MACnBC,GAAI6C,EAAOtC,KAAKuC,UAGnBC,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,OAGd,WACdpB,EAAauB,UAAUP,MAAK,SAACQ,GAC3B5C,EAAa,CAACZ,KAAM,gBACnBmD,OAAM,SAAAC,GACPC,QAAQC,IAAIF,SCCHK,EAvBD,WAEZ,MAAgCZ,IAAhC,mBAAOlC,EAAP,KAAa+C,EAAb,KAAqBH,EAArB,KAGA,OACE,yBAAKI,UAAU,SACb,yCACEhD,EAAKf,UAAY,4BAAQgE,QAASF,GAAjB,WAClB/C,EAAKf,UACJ,oCACE,qCAAWe,EAAKV,aAChB,4BAAQ2D,QAASL,GAAjB,YACA,6CACA,0F,QCWKM,EAzBM,SAACC,GAEpB,MAAwBC,mBAAS,IAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAoCF,mBAASD,GAA7C,mBAAOxB,EAAP,KAAmB4B,EAAnB,KAkBA,OAhBAC,qBAAU,WACR,IAAMC,EAAsBzC,EAAiBW,WAAWA,GACrD+B,QAAQ,YAAa,QACrBC,YAAW,SAAAC,GACV,IAAIC,EAAY,GAChBD,EAASE,SAAQ,SAAAC,GACfF,EAAUG,KAAV,2BAAmBD,EAASlB,QAA5B,IAAoCpD,GAAIsE,EAAStE,SAEnD6D,EAAQO,MAGZ,OAAO,kBAAMJ,KACZ,CAAC9B,IAIG,CAAE0B,OAAME,kBCKFU,EA3BD,SAAC,GAAwB,IAAvBC,EAAsB,EAAtBA,IAAKC,EAAiB,EAAjBA,YAEnB,EAA0Cf,oBAAS,GAAnD,mBAAOgB,EAAP,KAAsBC,EAAtB,KAEA,OACE,oCAEA,yBAAKrB,UAAU,iBACb,yBACEsB,IAAKJ,EACLK,IAAI,iBACJC,YAAa,kBAAMH,GAAiB,IACpCI,WAAY,kBAAMJ,GAAiB,OAGtCD,GACC,4BACEpB,UAAU,aACVC,QAASkB,GAFX,OCKSO,EAjBG,WAEhB,MAAexC,IAARlC,EAAP,oBACQqD,EAASH,EAAalD,EAAKP,IAA3B4D,KAGR,OACE,yBAAKL,UAAU,YACXK,GAAQA,EAAKsB,KAAI,SAAA1C,GAAG,OACpB,yBAAKe,UAAU,WAAW4B,IAAK3C,EAAIxC,IACjC,kBAAC,EAAD,CAAOyE,IAAKjC,EAAIiC,IAAKC,YAAc,kBAAMzC,EAAW1B,EAAKP,GAAIwC,EAAIxC,GAAIwC,EAAIL,WAAYgD,IAAK3C,EAAIxC,WCblGoF,EAAe,CACnBC,SAAU,EACVC,MAAO,GACPC,QAAS,IAGLC,EAAiB,SAAC9F,EAAOC,GAC7B,OAAOA,EAAOC,MACZ,IAAK,kBACH,OAAO,2BACFF,GADL,IAEE4F,MAAO,KACPD,SAAU1F,EAAOG,UAErB,IAAK,QACH,MAAO,CACLwF,MAAO3F,EAAOG,SAGlB,IAAK,UACH,OAAO,2BACFJ,GADL,IAEE4F,MAAO,KACPC,QAAS5F,EAAOG,YA2CT2F,EA9BI,SAACC,EAAMhC,GACxB,MAAmCpD,qBAAWkF,EAAgBJ,GAA9D,mBAAO9D,EAAP,KAAgBqE,EAAhB,KACA,EAAoChC,mBAASD,GAA7C,mBAAOxB,EAAP,UAwBA,OAtBA6B,qBAAU,WAER,IAAM5B,EAda,SAACyD,GAEtB,IAAIC,GADJD,EAAMA,EAAIE,MAAM,wBACIC,MAGpB,OAFAH,EAAIrB,KAAKyB,KAAKC,MAAOJ,GAEdD,EAAIM,OAAOC,QAAQ,IAAK,IASZC,CAAeV,EAAKW,MAC/BC,EAAgB/E,EAAiBW,WAAWA,GAE5CG,EAAahB,EAAeiB,IAAIH,GAEtCE,EAAWkE,IAAIb,GAAMc,GAAG,iBAAiB,SAACrC,GACxCwB,EAAgB,CAAC/F,KAAM,kBAAmBE,QAAUqE,EAASsC,iBAAmBtC,EAASuC,WAAc,SACtG,SAACpB,GACFK,EAAgB,CAAC/F,KAAM,QAASE,QAASwF,MAH3C,sBAIG,4BAAAlD,EAAA,sEAEiBC,EAAWsE,iBAF5B,OAEKlC,EAFL,OAGD6B,EAAcM,IAAI,CAACzE,WAAUsC,MAAKoC,UAAWpF,MAC7CkE,EAAgB,CAAC/F,KAAM,UAAWE,QAAS2E,IAJ1C,8CAOF,CAACiB,EAAMxD,IAIHZ,GCzCMwF,EApBK,SAAC,GAAuB,IAAtBpB,EAAqB,EAArBA,KAAMqB,EAAe,EAAfA,UAE1B,EAA+BrE,qBAAWzC,GAAlCM,EAAR,EAAQA,KAER,GAFA,EAAcC,aAEqBiF,EAAWC,EAAMnF,EAAKP,KAAlDqF,EAAP,EAAOA,SAAiBE,GAAxB,EAAiBD,MAAjB,EAAwBC,SASxB,OAPAxB,qBAAU,WACLwB,GACDwB,MACD,CAACxB,EAASwB,IAEb9D,QAAQC,IAAImC,GAGV,yBAAK9B,UAAU,gBACb,8BAAU7C,MAAO2E,EAAU2B,IAAK,IAAKC,MAAO,CAACC,MAAO,YChBpD9B,EAAe,CACnBM,KAAM,KACNJ,MAAO,MAGH6B,EAAc,SAACzH,EAAOC,GAC1B,OAAOA,EAAOC,MAEZ,IAAK,WACH,MAAO,CACL8F,KAAM/F,EAAOG,QACbwF,MAAO,MAGX,IAAK,QACH,MAAO,CACLI,KAAM,KACNJ,MAAO3F,EAAOG,SAGlB,IAAK,QACH,MAAO,CACL4F,KAAM,KACNJ,MAAO,MAGX,QACE,OAAO5F,IAiCE0H,EA7BI,WAEjB,MAA6B9G,qBAAW6G,EAAa/B,GAArD,mBAAOM,EAAP,KAAa2B,EAAb,KACMC,EAAmB,CAAC,YAAa,cAWvC,OACE,8BACE,+BACE,2BAAO1H,KAAK,OAAO2H,SAZM,SAACC,GAC9B,IAAIC,EAAeD,EAAEE,OAAOC,MAAM,GAC/BF,GAAgBH,EAAiBM,SAASH,EAAa7H,MACxDyH,EAAa,CAACzH,KAAM,WAAYE,QAAS2H,IAEzCJ,EAAa,CAACzH,KAAM,QAASE,QAAS,2DAQpC,oCAEF,yBAAKyD,UAAU,UACZmC,EAAKJ,OAAS,4BAAKI,EAAKJ,OACxBI,EAAKA,MAAQ,4BAAKA,EAAKA,KAAKW,MAC5BX,EAAKA,MAAQ,kBAAC,EAAD,CAAaA,KAAMA,EAAKA,KAAMqB,UAAW,kBAAMM,EAAa,CAACzH,KAAM,gBCjC1EiI,MAlBf,WAEE,MAAgCpF,IAAhC,mBAAOlC,EAAP,KAEA,OAFA,UAIE,yBAAKgD,UAAU,OACb,kBAAC,EAAD,MACChD,EAAKf,UACJ,oCACE,kBAAC,EAAD,MACA,kBAAC,EAAD,SCXVsI,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAACC,EAAD,KACE,kBAAC,EAAD,QAGJ3D,SAAS4D,eAAe,W","file":"static/js/main.30b249d4.chunk.js","sourcesContent":["import React, { useReducer } from 'react';\n\nconst initialUserState = {\n  loggedIn: false\n}\n\nconst userReducer = (state, action) => {\n  switch(action.type) {\n    case 'sign_in':\n      return {\n        loggedIn: true,\n        displayName: action.payload.displayName,\n        email: action.payload.email,\n        id: action.payload.id\n      }\n    case 'sign_out':\n      return {\n        loggedIn: false,\n      }\n    default:\n      return state\n  }\n}\n\nconst UserContext = React.createContext();\n\nconst UserProvider = (props) => {\n\n  const [user, userDispatch] = useReducer(userReducer, initialUserState)\n\n  return (\n    <UserContext.Provider value={{user, userDispatch}}>\n      {props.children}\n    </UserContext.Provider>\n  );\n}\nexport { UserContext }\nexport default UserProvider;\n","const firebaseConfig = {\n  apiKey: \"AIzaSyDs77phTnoaiUAZZd8ak_Gvv5ozeBtZ4XM\",\n  authDomain: \"firegram-70a8a.firebaseapp.com\",\n  projectId: \"firegram-70a8a\",\n  storageBucket: \"firegram-70a8a.appspot.com\",\n  messagingSenderId: \"984077982923\",\n  appId: \"1:984077982923:web:eff5bef8df8968bf538f4e\"\n};\n\nexport default firebaseConfig","import firebaseConfig from './config'\nimport firebase from 'firebase/app'\nimport 'firebase/storage'\nimport 'firebase/firestore'\nimport 'firebase/auth'\n\n\n// Initialize Firebase\nfirebase.initializeApp(firebaseConfig)\n\nconst projectStorage = firebase.storage()\nconst projectFirestore = firebase.firestore()\nconst createTimestamp = firebase.firestore.FieldValue.serverTimestamp\nconst deleteField = firebase.firestore.FieldValue.delete\n\n// auth\nconst firebaseAuth = firebase.auth()\nconst googleAuthProvider = new firebase.auth.GoogleAuthProvider();\n\nconst deleteFile = async(collection, id, fileName) => {\n  const storageRef = projectStorage.ref(fileName)\n  var dbRef = projectFirestore.collection(collection).doc(id)\n  await storageRef.delete()\n  await dbRef.delete()\n}\n\nexport async function getCurrentUser() {\n  const currUser = await firebaseAuth.currentUser\n  return currUser\n}\n\nexport { \n  projectStorage,\n  projectFirestore,\n  createTimestamp,\n  deleteField,\n  deleteFile,\n  firebaseAuth,\n  googleAuthProvider,\n}","import { useContext } from \"react\"\nimport { UserContext } from \"../contexts/User\";\nimport { firebaseAuth, googleAuthProvider } from '../firebase/firebaseFunctions';\n\nconst useUser = () => {\n\n  const { user, userDispatch } = useContext(UserContext)\n\n  const signIn = () => {\n    firebaseAuth.signInWithPopup(googleAuthProvider).then((result) => {\n      userDispatch({\n        type: 'sign_in',\n        payload: {\n          displayName: result.user.displayName,\n          email: result.user.email,\n          id: result.user.uid\n        }\n      })\n    }).catch(err => console.log(err))\n  }\n  \n  const signOut = () => {\n    firebaseAuth.signOut().then((data) => {\n      userDispatch({type: 'sign_out'})\n    }).catch(err => {\n      console.log(err)\n    })\n  }\n\n  return [user, signIn, signOut]\n\n}\n\nexport default useUser","import React, { useContext } from 'react';\nimport useUser from '../hooks/useUser';\n\nconst Title = () => {\n  \n  const [user, signIn, signOut] = useUser()\n\n  \n  return (\n    <div className=\"title\">\n      <h1>FireGram</h1>\n      {!user.loggedIn && <button onClick={signIn}>Sign In</button>}\n      {user.loggedIn && \n        <>\n          <p>Hello, {user.displayName}</p>\n          <button onClick={signOut}>Sign Out</button>\n          <h2>Your Pictures</h2>\n          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>\n        </>\n      }\n\n      \n    </div>\n  )\n}\n\nexport default Title;","import { useState, useEffect } from 'react'\nimport { projectFirestore } from '../firebase/firebaseFunctions';\n\nconst useFirestore = (collectionName) => {\n  \n  const [docs, setDocs] = useState([])\n  const [collection, setCollection] = useState(collectionName)\n\n  useEffect(() => {\n    const unsubFromCollection = projectFirestore.collection(collection)\n      .orderBy('createdAt', 'desc')\n      .onSnapshot(snapshot => { // fired once, then whenever a change occurs in a collection\n        let documents = []\n        snapshot.forEach(document => {\n          documents.push({...document.data(), id: document.id})\n        })\n        setDocs(documents)\n      })\n\n    return () => unsubFromCollection\n  }, [collection])\n\n  \n\n  return { docs, setCollection }\n\n}\n\nexport default useFirestore;\n","import React, { useContext, useState } from 'react';\n\nconst Image = ({url, deleteImage}) => {\n\n  const [deleteIsShown, setDeleteIsShown] = useState(false);\n\n  return (\n    <>\n    \n    <div className='img-container'>\n      <img \n        src={url}\n        alt=\"uploaded image\"\n        onMouseOver={() => setDeleteIsShown(true)}\n        onMouseOut={() => setDeleteIsShown(false)}\n      />\n    </div>\n    {deleteIsShown && \n      <button \n        className=\"delete-btn\"\n        onClick={deleteImage}\n      >\n        X\n      </button>\n    }\n    </>\n  );\n}\n\nexport default Image;\n","import React from 'react';\nimport useFirestore from '../hooks/useFirestore';\nimport Image from './Image';\nimport { deleteFile } from '../firebase/firebaseFunctions.js'\nimport useUser from '../hooks/useUser';\n\nconst ImageGrid = () => {\n\n  const [user] = useUser()\n  const { docs } = useFirestore(user.id)\n  \n\n  return (\n    <div className=\"img-grid\">\n      { docs && docs.map(doc => (\n        <div className=\"img-wrap\" key={doc.id}>\n          <Image url={doc.url} deleteImage={ () => deleteFile(user.id, doc.id, doc.fileName) } key={doc.id}></Image>\n        </div>\n      ))}      \n    </div>\n  );\n}\n\nexport default ImageGrid;\n","import React, { useReducer, useEffect, useState } from 'react';\nimport { projectStorage, projectFirestore, createTimestamp } from '../firebase/firebaseFunctions';\n\nconst initialState = {\n  progress: 0,\n  error: '',\n  fileUrl: ''\n}\n\nconst storageReducer = (state, action) => {\n  switch(action.type) {\n    case 'update_progress':\n      return {\n        ...state,\n        error: null,\n        progress: action.payload\n      }\n    case 'error':\n      return {\n        error: action.payload\n      }\n\n    case 'set_url':\n      return {\n        ...state,\n        error: null,\n        fileUrl: action.payload\n      }\n  }\n}\n\nconst fileNameWithId = (str) => {\n  str = str.split(/(?=.png|.jpg|.jpeg)/)\n  let extension = str.pop()\n  str.push(Date.now(), extension)\n\n  return str.join().replace(',', '')\n}\n\nconst useStorage = (file, collectionName) => {\n  const [storage, storageDispatch] = useReducer(storageReducer, initialState)\n  const [collection, setCollection] = useState(collectionName)\n\n  useEffect(() => {\n    // add unique id onto image name\n    const fileName = fileNameWithId(file.name)\n    const collectionRef = projectFirestore.collection(collection)\n\n    const storageRef = projectStorage.ref(fileName)\n\n    storageRef.put(file).on('state_changed', (snapshot) => {\n      storageDispatch({type: 'update_progress', payload: (snapshot.bytesTransferred / snapshot.totalBytes) * 100})\n    }, (error) => {\n      storageDispatch({type: 'error', payload: error})\n    }, async () => {\n      // on complete\n      const url = await storageRef.getDownloadURL()\n      collectionRef.add({fileName, url, createdAt: createTimestamp()})\n      storageDispatch({type: 'set_url', payload: url})\n    })\n\n  }, [file, collection])\n\n  \n\n  return storage\n\n}\n\nexport default useStorage;\n","import React, { useContext, useEffect } from 'react';\nimport { UserContext } from '../contexts/User';\nimport useStorage from '../hooks/useStorage';\n\nconst ProgressBar = ({file, resetFile}) => {\n\n  const { user, userDispatch } = useContext(UserContext)\n\n  const {progress, error, fileUrl} = useStorage(file, user.id)\n\n  useEffect(() => {\n    if(fileUrl)\n      resetFile()\n  }, [fileUrl, resetFile])\n\n  console.log(progress)\n\n  return (\n    <div className='progress-bar'>\n      <progress value={progress} max={100} style={{width: '100%'}}></progress>\n    </div>\n  );\n}\n\nexport default ProgressBar;\n","import React, { useReducer } from 'react';\nimport ProgressBar from './ProgressBar';\n\nconst initialState = {\n  file: null,\n  error: null\n}\n\nconst fileReducer = (state, action) => {\n  switch(action.type) {\n\n    case 'set_file':\n      return {\n        file: action.payload,\n        error: null\n      }\n\n    case 'error':\n      return {\n        file: null,\n        error: action.payload\n      }\n\n    case 'reset':\n      return {\n        file: null,\n        error: null\n      }\n    \n    default:\n      return state\n  }\n}\n\nconst UploadForm = () => {\n\n  const [file, fileDispatch] = useReducer(fileReducer, initialState)\n  const allowedFileTypes = ['image/png', 'image/jpeg']\n\n  const fileInputChangeHandler = (e) => {\n    let selectedFile = e.target.files[0] // if user clicks 'cancel' then selectedFile will be undefined\n    if(selectedFile && allowedFileTypes.includes(selectedFile.type)) {\n      fileDispatch({type: 'set_file', payload: selectedFile})\n    } else {\n      fileDispatch({type: 'error', payload: 'Error: Selected file is not of type PNG or JPG/JPEG'})\n    }\n  }\n\n  return (\n    <form>\n      <label>\n        <input type=\"file\" onChange={fileInputChangeHandler} />\n        <span>+</span>\n      </label>\n      <div className=\"output\">\n        {file.error && <h1>{file.error}</h1>}\n        {file.file && <h1>{file.file.name}</h1>}\n        {file.file && <ProgressBar file={file.file} resetFile={() => fileDispatch({type: 'reset'})}/>}\n      </div>\n    </form>\n  );\n}\n\nexport default UploadForm;\n","import React from 'react';\nimport Title from './components/Title'\nimport ImageGrid from './components/ImageGrid';\nimport UploadForm from './components/UploadForm';\nimport useUser from './hooks/useUser';\n\nfunction App() {\n\n  const [user, signIn, signOut] = useUser()\n\n  return (\n    \n    <div className=\"App\">\n      <Title/>\n      {user.loggedIn &&\n        <>\n          <UploadForm/>\n          <ImageGrid/>\n        </>\n      }\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport UserProvider from './contexts/User'\n\nReactDOM.render(\n  <React.StrictMode>\n    <UserProvider>\n      <App />\n    </UserProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA"],"sourceRoot":""}